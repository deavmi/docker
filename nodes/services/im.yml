services:
  sshchat:
    extends:
      file: ../../services/sshchat/compose.yml
      service: sshchat
    networks:
      - mainNet
    ports:
      - "2000:2022/tcp"

  matterbridge:
    extends:
      file: ../../services/matterbridge/compose.yml
      service: matterbridge
    build:
      context: matterbridge/
    depends_on:
      - ircd
      - sshchat
    networks:
      - mainNet

  # xmpp:
    # image: prosody/prosody
    # container_name: xmpp
    # environment:
    # 
      # # Logging level
      # - PROSODY_LOGLEVEL=debug
    # volumes:
      # # Path for certificates
      # - ${PROSODY_CERT_PATH}:/etc/prosody:z
    # networks:
      # - mainNet
    # 

  xmpp:
    build:
      context: ejabberd/
    container_name: xmpp
    environment:
      # - REGISTER_ADMIN_PASSWORD
      - EJABBERD_MACRO_ADMIN=admin@${XMPP_DOMAIN}
      - EJABBERD_MACRO_HOST=${XMPP_DOMAIN}
    networks:
      - mainNet
    ports:
      - "5222:5222/tcp"

      # HTTP (for ACME)
      - "5280:5280/tcp"
